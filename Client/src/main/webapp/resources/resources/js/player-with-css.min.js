!function(e,t){var i=e.createElement("style");if(e.getElementsByTagName("head")[0].appendChild(i),i.styleSheet)i.styleSheet.disabled||(i.styleSheet.cssText=t);else try{i.innerHTML=t}catch(r){i.innerText=t}}(document,"@-webkit-keyframes ge-roll{from{-webkit-transform:rotate(0);transform:rotate(0)}to{-webkit-transform:rotate(360deg);transform:rotate(360deg)}}@keyframes ge-roll{from{-webkit-transform:rotate(0);transform:rotate(0)}to{-webkit-transform:rotate(360deg);transform:rotate(360deg)}}.ge-player{background:#fff;box-shadow:0 0 10px gray;border-radius:3px;position:relative;max-width:400px}.ge-player .button{cursor:pointer}.ge-player .button.active,.ge-player .button:hover{color:#1e90ff}.ge-player .image{position:absolute;width:130px;height:130px;left:10px;top:10px;-webkit-animation:ge-roll 8s linear infinite;animation:ge-roll 8s linear infinite;-webkit-animation-play-state:paused;animation-play-state:paused}.ge-player .image img{width:100%;height:100%;border-radius:50%}.ge-player .ge-roll{-webkit-animation-play-state:running;animation-play-state:running}.ge-player .buttons{position:absolute;top:10px;right:10px}.ge-player .buttons>.button{margin-left:5px}.ge-player .control{padding:30px 10px 10px 150px;height:150px;text-align:center}.ge-player .control i{margin:10px;font-size:30px}.ge-player .lyric{text-align:center;color:brown;font-size:.8em;height:2em}.ge-player .progress{padding:.5em 1em}.ge-player .progress .wrap{position:relative}.ge-player .progress .barwrap{padding:4px 0}.ge-player .progress .bar{height:2px;background:silver;position:relative}.ge-player .progress .played{position:absolute;top:0;height:2px;background:brown}.ge-player .progress .cursor{cursor:pointer;position:absolute;border:1px solid silver;background:#fff;border-radius:50%;width:10px;height:10px;top:0;margin-left:-5px}.ge-player .progress .time{font-size:.7em;position:absolute;right:0;top:-2em}.ge-player .playlist{max-height:200px;border-top:1px dashed gray;padding:.5em 1em;overflow-y:auto}.ge-player .playlist.hide{display:none}.ge-player .playlist>div{white-space:nowrap;text-overflow:ellipsis;color:#1a1a1a;cursor:pointer}.ge-player .playlist>div.active{color:#1e90ff;font-weight:700}.ge-player .playlist>div:hover{color:orange;font-weight:700}"),function(){function e(e){var t=this;t.parent=e,"ontouchstart"in window?t.initTouch():"onmousedown"in window&&(t.mouse=!0)}function t(){this.data=[],this.last=0}function r(e){this.options=e,this.init()}e.prototype={threshold:5,initTouch:function(){var e=this,t=e.touchHandler.bind(e);e.touch=!0,e.parent.addEventListener("touchstart",t,!1),e.parent.addEventListener("touchmove",t,!1),e.parent.addEventListener("touchend",t,!1),e.touches={},e.data=[]},findItem:function(e){var t,i,r=this.data;for(t=0;t<r.length;t++)if(i=r[t],i.element===e)return i},addListener:function(e,t,r){var a=this;if(a.mouse&&e.addEventListener(t,r,!1),a.touch){var n=a.findItem(e);n?i=n.events[t]:(n={element:e,events:{}},a.data.push(n),i=null),i||(n.events[t]=i=[]),i.push(r)}},removeListener:function(e,t,i){var r=this;if(r.mouse&&e.removeEventListener(t,i,!1),r.touch){var a,n,o=r.findItem(e);o&&(a=o.events[t],a&&(n=a.indexOf(i),n>=0&&a.splice(n,1)))}},ignore:function(){},fire:function(e,t){for(var i=this,r=function(r){var a,o=null;for(a=0;a<i.data.length;a++)if(i.data[a].element===r){o=i.data[a];break}if(o){var s=o.events[e];s&&i.forEach(s,function(a){var o,s={type:e};for(o in t)s[o]=t[o];s.preventDefault=i.ignore,s.stopPropagation=n,a.call(r,s)})}},a=!1,n=function(){a=!0},o=t.target;o&&(r(o),!a&&o!==i.parent);)o=o.parentNode},forEach:function(e,t){Array.prototype.forEach.call(e,t)},touchHandler:function(e){var t=this;e.preventDefault(),"touchstart"==e.type?t.forEach(e.changedTouches,function(e){t.touches[e.identifier]={evt:e},t.fire("mousedown",e)}):"touchmove"==e.type?t.forEach(e.changedTouches,function(e){var i=t.touches[e.identifier],r=i.evt;i.moved=i.moved||Math.abs(e.clientX-r.clientX)>t.threshold||Math.abs(e.clientY-r.clientY)>t.threshold,i.moved&&(i.evt=e,t.fire("mousemove",e))}):"touchend"==e.type&&t.forEach(e.changedTouches,function(e){t.fire("mouseup",e);var i=t.touches[e.identifier];delete t.touches[e.identifier],i&&!i.moved&&t.fire("click",e)})},getPoint:function(e){if("offsetX"in e)return{x:e.offsetX,y:e.offsetY};var t=e.target.getBoundingClientRect(),i=document.documentElement,r=window;return{x:e.pageX-(t.left+r.pageXOffset-i.clientLeft),y:e.pageY-(t.top+r.pageYOffset-i.clientTop)}}},t.prototype={setLyric:function(e){var t=this.data=[];if(this.last=0,e){var i=/^\[([^\]]*)\]\s*(.*)$/;e.split(/\n/).forEach(function(e){var r=e.match(i);if(r){var a=0;r[1].split(/:/).forEach(function(e){a=60*a+Number(e)}),t.push([a,r[2]])}})}},getLyricAtTime:function(e){var t,i=this,r=i.data,a=i.last,n=r[a]||r[a=0];if(n)if(n[0]<e){for(;(t=r[++a])&&t[0]<=e;)n=t;i.last=a-1}else{for(;n&&n[0]>e;)n=r[--a];i.last=a}return n?n[1]:""}},r.prototype={_classes:{list:"fa fa-list",prev:"fa fa-step-backward",play:"fa fa-play",next:"fa fa-step-forward",pause:"fa fa-pause"},extend:function(e,t){for(var i in t)e[i]=t[i];return e},init:function(){var e=this,i=e.options.container;e.classes=e.extend({},e._classes),e.options.classes&&e.extend(e.classes,e.options.classes),i.classList.add("ge-player"),i.innerHTML='<div class="image"></div><div class="buttons"><i data="list" class="button '+e.classes.list+'"></i></div><div class="control"><div class="title"></div><i data="prev" class="button '+e.classes.prev+'"></i><i data="play" class="button '+e.classes.play+'"></i><i data="next" class="button '+e.classes.next+'"></i></div><div class="progress"><div class="wrap"><div class="barwrap"><div class="bar"><div class="played"></div></div></div><div class="cursor"></div><div class="time"></div></div></div><div class="lyric"></div><div class="playlist hide"></div>',e.image=i.querySelector(".image"),e.title=i.querySelector(".title"),e.playlist=i.querySelector(".playlist"),e.prwrap=i.querySelector(".barwrap"),e.prcur=i.querySelector(".cursor"),e.prtime=i.querySelector(".time"),e.brplayed=i.querySelector(".played"),e.lyric=i.querySelector(".lyric"),Array.prototype.forEach.call(i.querySelectorAll(".button[data]"),function(t){e["bt"+t.getAttribute("data")]=t}),e.audio=new Audio,e.options.image&&(e.image.innerHTML='<img src="'+e.safeHTML(e.options.image)+'">'),e.setSongs([]),e.lyricParser=new t,e.bindEvents()},bindEvents:function(){var t=this,i=null,r=new e(t.options.container);r.addListener(t.btlist,"click",function(e){this.classList.toggle("active"),t.playlist.classList.toggle("hide")}),r.addListener(t.btprev,"click",function(e){t.play(t.previous())}),r.addListener(t.btnext,"click",function(e){t.play(t.next())}),r.addListener(t.btplay,"click",function(e){t.current<0?t.play(0):t.audio.paused?t.audio.play():t.audio.pause()}),t.audio.addEventListener("ended",function(e){t.play(t.next())},!1),t.audio.addEventListener("timeupdate",function(e){var r=this.currentTime,a=t.duration;if(a||(a=t.duration=this.duration),!i){var n=a?r/a*100+"%":0;t.prcur.style.left=n,t.brplayed.style.width=n}t.prtime.innerHTML=t.timestr(r)+" / "+t.timestr(a),t.lyric.innerHTML=t.safeHTML(t.lyricParser.getLyricAtTime(r))},!1);var a=function(e){var i=["play","pause"];"pause"==e.type&&i.reverse();var r=t.btplay.classList;t.classes[i[0]].split(/\s+/).forEach(function(e){r.remove(e)}),t.classes[i[1]].split(/\s+/).forEach(function(e){r.add(e)}),t.image.classList["play"==e.type?"add":"remove"]("ge-roll")};t.audio.addEventListener("play",a,!1),t.audio.addEventListener("pause",a,!1),r.addListener(t.playlist,"click",function(e){var i=Array.prototype.indexOf.call(this.childNodes,e.target);i>=0&&t.play(i)});var n=function(e,i){var r=e/t.prwrap.offsetWidth;0>r?r=0:r>1&&(r=1),t.prcur.style.left=t.brplayed.style.width=100*r+"%",i&&(t.audio.currentTime=~~(r*t.duration))};r.addListener(t.prwrap,"click",function(e){e.preventDefault();var t=r.getPoint(e).x;n(t,!0)});var o=function(e){i&&(i.moved=!0,n(e.clientX-i.delta))},s=function(e){i&&(e.preventDefault(),i=null)},l=function(e){i&&(n(e.clientX-i.delta,!0),s(e))},c=function(e){e.preventDefault(),i={delta:e.clientX-t.brplayed.offsetWidth}};r.addListener(t.prcur,"mousedown",c),r.addListener(t.options.container,"mousemove",o),r.addListener(t.options.container,"mouseup",l),t.options.container.addEventListener("mouseleave",s,!1)},safeHTML:function(e){return e.replace(/[&"<]/g,function(e){return{"&":"&amp;",'"':"&quot;","<":"&lt;"}[e]})},setSongs:function(e){var t=this,i=[];t.songs=e,t.songs.forEach(function(e){var r=t.safeHTML(e.name);i.push('<div title="'+r+'">'+r+"</div>")}),t.playlist.innerHTML=i.join(""),t.current=-1,t.duration=0},getLyric:function(){var e=this,t=e.songs[e.current];if("lyric"in t)e.lyricParser.setLyric(t.lyric);else if("lyricjsonp"in t){var i="setLyric"+Date.now().toString(16)+(~~(65535*Math.random())).toString(16);window[i]=function(r){200!=r.code?t.lyric=null:e.lyricParser.setLyric(t.lyric=r.lyric),delete window[i]};var r=document.createElement("script");r.src=t.lyricjsonp+(/\?/.test(t.lyricjsonp)?"&":"?")+"jsonp="+i,r.onload=function(){document.body.removeChild(r)},document.body.appendChild(r)}},play:function(e){var t=this;if(e>=0&&e<t.songs.length){if(t.current==e)t.audio.currentTime=0;else{var i=t.playlist.childNodes,r=i[t.current];r&&r.classList.remove("active"),t.current=e,i[t.current].classList.add("active");var a=t.songs[t.current];t.title.innerHTML=t.safeHTML(a.name),t.audio.src=a.url,t.duration=a.duration?a.duration/1e3:null;var n=a.image||t.options.image;n&&(t.image.innerHTML='<img src="'+t.safeHTML(n)+'">'),t.lyric.innerHTML="",t.getLyric()}t.prtime.innerHTML="",t.prcur.style.left=0,t.brplayed.style.width=0,t.audio.play()}},previous:function(){return(this.current-1)%this.songs.length},next:function(){return(this.current+1)%this.songs.length},timestr:function(e){if(isNaN(e))return"??:??";var t=Math.floor(e/60);return e=Math.floor(e)%60,10>e&&(e="0"+e),10>t&&(t="0"+t),t+":"+e}},window.Player=r}.call({});